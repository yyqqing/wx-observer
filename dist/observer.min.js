/*!
 * WxObserver.js v0.0.1
 * (c) 2014-2018 yyqqing
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Vue={})}(this,function(t){"use strict";Object.freeze({});function e(t){return null!==t&&"object"==typeof t}var n=Object.prototype.toString;function r(t){return"[object Object]"===n.call(t)}function i(t,e){for(var n=Object.create(null),r=t.split(","),i=0;i<r.length;i++)n[r[i]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}i("slot,component",!0),i("key,ref,slot,slot-scope,is");function s(t,e){if(t.length){var n=t.indexOf(e);if(n>-1)return t.splice(n,1)}}var o=Object.prototype.hasOwnProperty;function a(t,e){return o.call(t,e)}function c(t,e,n){}function h(t){var e=(t+"").charCodeAt(0);return 36===e||95===e}function u(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!!r,writable:!0,configurable:!0})}var f=/[^\w.$]/;var p,l="__proto__"in{},d=function(){return!1};function v(t){return"function"==typeof t&&/native code/.test(t.toString())}function y(t,e,n){console.log("handleError :: ",t,e,n)}p="undefined"!=typeof Set&&v(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var _,b,g=[],w=!1;function m(){w=!1;var t=g.slice(0);g.length=0;for(var e=0;e<t.length;e++)t[e]()}var O=!1;if("undefined"!=typeof setImmediate&&v(setImmediate))b=function(){setImmediate(m)};else if("undefined"==typeof MessageChannel||!v(MessageChannel)&&"[object MessageChannelConstructor]"!==MessageChannel.toString())b=function(){setTimeout(m,0)};else{var j=new MessageChannel,D=j.port2;j.port1.onmessage=m,b=function(){D.postMessage(1)}}if("undefined"!=typeof Promise&&v(Promise)){var A=Promise.resolve();_=function(){A.then(m)}}else _=b;var I=0,k=function(){this.id=I++,this.subs=[]};k.prototype.addSub=function(t){this.subs.push(t)},k.prototype.removeSub=function(t){s(this.subs,t)},k.prototype.depend=function(){k.target&&k.target.addDep(this)},k.prototype.notify=function(){for(var t=this.subs.slice(),e=0,n=t.length;e<n;e++)t[e].update()},k.target=null;var P=[];var x=Array.prototype,C=Object.create(x);["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(t){var e=x[t];u(C,t,function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];var i,s=e.apply(this,n),o=this.__ob__;switch(t){case"push":case"unshift":i=n;break;case"splice":i=n.slice(2)}return i&&o.observeArray(i),o.dep.notify(),s})});var S=Object.getOwnPropertyNames(C),z={shouldConvert:!0},E=function(t){(this.value=t,this.dep=new k,this.vmCount=0,u(t,"__ob__",this),Array.isArray(t))?((l?M:W)(t,C,S),this.observeArray(t)):this.walk(t)};function M(t,e,n){t.__proto__=e}function W(t,e,n){for(var r=0,i=n.length;r<i;r++){var s=n[r];u(t,s,e[s])}}function L(t,n){var i;if(e(t))return a(t,"__ob__")&&t.__ob__ instanceof E?i=t.__ob__:z.shouldConvert&&!d()&&(Array.isArray(t)||r(t))&&Object.isExtensible(t)&&!t._isVue&&(i=new E(t)),n&&i&&i.vmCount++,i}function T(t,e,n,r,i){var s=new k,o=Object.getOwnPropertyDescriptor(t,e);if(!o||!1!==o.configurable){var a=o&&o.get,c=o&&o.set,h=!i&&L(n);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=a?a.call(t):n;return k.target&&(s.depend(),h&&(h.dep.depend(),Array.isArray(e)&&function t(e){for(var n=void 0,r=0,i=e.length;r<i;r++)(n=e[r])&&n.__ob__&&n.__ob__.dep.depend(),Array.isArray(n)&&t(n)}(e))),e},set:function(e){var r=a?a.call(t):n;e===r||e!=e&&r!=r||(c?c.call(t,e):n=e,h=!i&&L(e),s.notify())}})}}E.prototype.walk=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)T(t,e[n],t[e[n]])},E.prototype.observeArray=function(t){for(var e=0,n=t.length;e<n;e++)L(t[e])};var U=new p;function V(t){!function t(n,r){var i,s;var o=Array.isArray(n);if(!o&&!e(n)||Object.isFrozen(n))return;if(n.__ob__){var a=n.__ob__.dep.id;if(r.has(a))return;r.add(a)}if(o)for(i=n.length;i--;)t(n[i],r);else for(s=Object.keys(n),i=s.length;i--;)t(n[s[i]],r)}(t,U),U.clear()}var $=[],B=[],F={},N=!1,q=!1,G=0;function H(){var t,e;for(q=!0,$.sort(function(t,e){return t.id-e.id}),G=0;G<$.length;G++)e=(t=$[G]).id,F[e]=null,t.run();var n=B.slice(),r=$.slice();G=$.length=B.length=0,F={},N=q=!1,function(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,t[e]}(n),function(t){var e=t.length;for(;e--;){var n=t[e],r=n.vm;r._watcher===n&&r._isMounted}}(r)}function J(t){var e=t.id;if(null==F[e]){if(F[e]=!0,q){for(var n=$.length-1;n>G&&$[n].id>t.id;)n--;$.splice(n+1,0,t)}else $.push(t);N||(N=!0,function(t,e){var n;if(g.push(function(){if(t)try{t.call(e)}catch(t){y(t,e,"nextTick")}else n&&n(e)}),w||(w=!0,O?b():_()),!t&&"undefined"!=typeof Promise)new Promise(function(t){n=t})}(H))}}var K=0,Q=function(t,e,n,r,i){this.vm=t,i&&(t._watcher=this),t._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++K,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new p,this.newDepIds=new p,this.expression=e.toString(),"function"==typeof e?this.getter=e:(this.getter=function(t){if(!f.test(t)){var e=t.split(".");return function(t){for(var n=0;n<e.length;n++){if(!t)return;t=t[e[n]]}return t}}}(e),this.getter||(this.getter=function(){})),this.value=this.lazy?void 0:this.get()};Q.prototype.get=function(){var t,e;t=this,k.target&&P.push(k.target),k.target=t;var n=this.vm;try{e=this.getter.call(n,n)}catch(t){if(!this.user)throw t;y(t,n,'getter for watcher "'+this.expression+'"')}finally{this.deep&&V(e),k.target=P.pop(),this.cleanupDeps()}return e},Q.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},Q.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},Q.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():J(this)},Q.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||e(t)||this.deep){var n=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,this.expression,t,n)}catch(t){y(t,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,this.expression,t,n)}}},Q.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},Q.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},Q.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||s(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var R={enumerable:!0,configurable:!0,get:c,set:c};var X=function(t){var e=this;this._watchers=[],this._computedWatchers=Object.create(null),this._render=t._update;var n=this._data=t.props||{};Object.keys(n).forEach(function(t){var n,r,i;h(t)||(n=e,r="_data",i=t,R.get=function(){return this[r][i]},R.set=function(t){this[r][i]=t},Object.defineProperty(n,i,R))}),Y(n,!1),function t(e,n,i){if(void 0===i&&(i=""),Array.isArray(n))for(var s=0,o=n.length;s<o;s++)t(e,n[s],i+s+".");else for(var a=Object.keys(n),c=0;c<a.length;c++){var u=i+a[c];if(!h(u)){new Q(e,u,e._renderDelegate);var f=n[a[c]];(Array.isArray(f)||r(f))&&Object.isExtensible(f)&&t(e,f,u+".")}}}(this,n)};X.prototype._renderDelegate=function(t,e,n){var r=t.replace(/\.(\d)\./g,"[$1].");this._render(r,e,n)},X.prototype.teardown=function(){var t=this;this._watchers.forEach(function(t){t.teardown()}),Object.keys(this._computedWatchers).forEach(function(e){t._computedWatchers[e].teardown()}),this._watchers=[],this._data={},this._computedWatchers={}};var Y=function(t,e){if(void 0===e&&(e=!0),a(t,"__ob__"))return t;L(t,e);var n=Object.create(null);return Object.keys(t).forEach(function(e){Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){return t[e]},set:function(n){t[e]=n}})}),n};t.observe=function(t){var e=t.onLoad,n=t.onUnload;return t.onLoad=function(){this._vm=new X(this),e&&e.apply(this,arguments)},t._update||(t._update=function(t,e,n){var r;this.setData(((r={})[""+t]=e,r[t+".oldval"]=n,r))}),t.onUnload=function(){this._vm&&this._vm.teardown(),n&&n.apply(this,arguments)},t},t.makeObservable=Y,Object.defineProperty(t,"__esModule",{value:!0})});