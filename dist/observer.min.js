/*!
 * WxObserver.js v0.1.2
 * (c) 2014-2018 yyqqing
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Vue=e()}(this,function(){"use strict";Object.freeze({});function a(t){return null!==t&&"object"==typeof t}var i=Object.prototype.toString;function s(t){var e=parseFloat(String(t));return 0<=e&&Math.floor(e)===e&&isFinite(t)}function t(t,e){for(var n=Object.create(null),r=t.split(","),i=0;i<r.length;i++)n[r[i]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}t("slot,component",!0),t("key,ref,slot,slot-scope,is");function e(t,e){if(t.length){var n=t.indexOf(e);if(-1<n)return t.splice(n,1)}}var n=Object.prototype.hasOwnProperty;function o(t,e){return n.call(t,e)}var f=Function.prototype.bind?function(t,e){return t.bind(e)}:function(n,r){function t(t){var e=arguments.length;return e?1<e?n.apply(r,arguments):n.call(r,t):n.call(r)}return t._length=n.length,t};function p(t,e,n){}function l(t){var e=(t+"").charCodeAt(0);return 36===e||95===e}function h(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!!r,writable:!0,configurable:!0})}var c=/[^\w.$]/;var u,r="__proto__"in{},d=function(){return!1};function v(t){return"function"==typeof t&&/native code/.test(t.toString())}function y(t,e,n){console.log("handleError :: ",t,e,n)}u="undefined"!=typeof Set&&v(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var _,g,b=[],m=!1;function w(){m=!1;for(var t=b.slice(0),e=b.length=0;e<t.length;e++)t[e]()}var j=!1;if("undefined"!=typeof setImmediate&&v(setImmediate))g=function(){setImmediate(w)};else if("undefined"==typeof MessageChannel||!v(MessageChannel)&&"[object MessageChannelConstructor]"!==MessageChannel.toString())g=function(){setTimeout(w,0)};else{var O=new MessageChannel,D=O.port2;O.port1.onmessage=w,g=function(){D.postMessage(1)}}if("undefined"!=typeof Promise&&v(Promise)){var A=Promise.resolve();_=function(){A.then(w)}}else _=g;var I=0,C=function(){this.id=I++,this.subs=[]};C.prototype.addSub=function(t){this.subs.push(t)},C.prototype.removeSub=function(t){e(this.subs,t)},C.prototype.depend=function(){C.target&&C.target.addDep(this)},C.prototype.notify=function(){for(var t=this.subs.slice(),e=0,n=t.length;e<n;e++)t[e].update()},C.target=null;var P=[];var S=Array.prototype,k=Object.create(S);["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(s){var o=S[s];h(k,s,function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r=o.apply(this,t),i=this.__ob__;switch(s){case"push":case"unshift":n=t;break;case"splice":n=t.slice(2)}return n&&i.observeArray(n),i.dep.notify(),r})});var x=Object.getOwnPropertyNames(k),M=!0;var z=function(t){var e;this.value=t,this.dep=new C,this.vmCount=0,h(t,"__ob__",this),Array.isArray(t)?(r?(e=k,t.__proto__=e):function(t,e,n){for(var r=0,i=n.length;r<i;r++){var s=n[r];h(t,s,e[s])}}(t,k,x),this.observeArray(t)):this.walk(t)};function E(t,e){var n,r;if(a(t))return o(t,"__ob__")&&t.__ob__ instanceof z?n=t.__ob__:!M||d()||!Array.isArray(t)&&(r=t,"[object Object]"!==i.call(r))||!Object.isExtensible(t)||t._isVue||(n=new z(t)),e&&n&&n.vmCount++,n}function F(n,t,r,e,i){var s=new C,o=Object.getOwnPropertyDescriptor(n,t);if(!o||!1!==o.configurable){var a=o&&o.get,h=o&&o.set;a&&!h||2!==arguments.length||(r=n[t]);var c=!i&&E(r);Object.defineProperty(n,t,{enumerable:!0,configurable:!0,get:function(){var t=a?a.call(n):r;return C.target&&(s.depend(),c&&(c.dep.depend(),Array.isArray(t)&&function t(e){for(var n=void 0,r=0,i=e.length;r<i;r++)(n=e[r])&&n.__ob__&&n.__ob__.dep.depend(),Array.isArray(n)&&t(n)}(t))),t},set:function(t){var e=a?a.call(n):r;t===e||t!=t&&e!=e||a&&!h||(h?h.call(n,t):r=t,c=!i&&E(t),s.notify())}})}}z.prototype.walk=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)F(t,e[n])},z.prototype.observeArray=function(t){for(var e=0,n=t.length;e<n;e++)E(t[e])};var K=new u;function V(t){!function t(e,n){var r,i;var s=Array.isArray(e);if(!s&&!a(e)||Object.isFrozen(e))return;if(e.__ob__){var o=e.__ob__.dep.id;if(n.has(o))return;n.add(o)}if(s)for(r=e.length;r--;)t(e[r],n);else for(i=Object.keys(e),r=i.length;r--;)t(e[i[r]],n)}(t,K),K.clear()}var W=[],L=[],T={},U=!1,B=!1,N=0;function $(){var t,e;for(B=!0,W.sort(function(t,e){return t.id-e.id}),N=0;N<W.length;N++)(t=W[N]).before&&t.before(),e=t.id,T[e]=null,t.run();var n=L.slice(),r=W.slice();N=W.length=L.length=0,U=B=!(T={}),function(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,t[e]}(n),function(t){var e=t.length;for(;e--;){var n=t[e],r=n.vm;r._watcher===n&&r._isMounted&&r._isDestroyed}}(r)}function q(t){var e=t.id;if(null==T[e]){if(T[e]=!0,B){for(var n=W.length-1;N<n&&W[n].id>t.id;)n--;W.splice(n+1,0,t)}else W.push(t);U||(U=!0,function(t,e){var n;if(b.push(function(){if(t)try{t.call(e)}catch(t){y(t,e,"nextTick")}else n&&n(e)}),m||(m=!0,j?g():_()),!t&&"undefined"!=typeof Promise)new Promise(function(t){n=t})}($))}}var G=0,H=function(t,e,n,r,i){this.vm=t,i&&(t._watcher=this),t._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++G,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new u,this.newDepIds=new u,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(t){if(!c.test(t)){var n=t.split(".");return function(t){for(var e=0;e<n.length;e++){if(!t)return;t=t[n[e]]}return t}}}(e),this.getter||(this.getter=p)),this.value=this.lazy?void 0:this.get()};H.prototype.get=function(){var t,e;t=this,C.target&&P.push(C.target),C.target=t;var n=this.vm;try{e=this.getter.call(n,n)}catch(t){if(!this.user)throw t;y(t,n,'getter for watcher "'+this.expression+'"')}finally{this.deep&&V(e),C.target=P.pop(),this.cleanupDeps()}return e},H.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},H.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},H.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():q(this)},H.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||a(t)||this.deep){var e=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,t,e)}catch(t){y(t,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,t,e)}}},H.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},H.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},H.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||e(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var J={enumerable:!0,configurable:!0,get:p,set:p},Q={computed:!0};function R(t,e,n){J.set="function"==typeof n?(J.get=n,p):(J.get=n.get?n.get:p,n.set?n.set:p),J.set===p&&(J.set=function(){console.log('Computed property "'+e+'" was assigned to but it has no setter.')}),Object.defineProperty(t,e,J)}var X=function(t){var i=this;this._watchers=[],this._dataKeys=[];var s=this;M=!0;var e=s._data=t.data||{};Object.keys(e).forEach(function(t){var e,n,r;l(t)||(e=s,n="_data",r=t,J.get=function(){return this[n][r]},J.set=function(t){this[n][r]=t},Object.defineProperty(e,r,J),i._dataKeys.push(t))}),E(e,!0);var n=t.computed,r=s._computedWatchers=Object.create(null);for(var o in n){l(o)||i._dataKeys.push(o);var a=n[o],h="function"==typeof a?a:a.get;r[o]=new H(s,h||p,p,Q),o in s?console.log('The computed property "'+o+'" is already defined in data.'):R(s,o,a)}var c=t.methods;for(var u in c)s[u]=null==c[u]?p:f(c[u],s)};X.prototype.allData=function(){var e=this,n={};return this._dataKeys.forEach(function(t){n[t]=e[t]}),n},X.prototype.teardown=function(){var e=this;this._watcher&&this._watcher.teardown(),this._watchers.forEach(function(t){t.teardown()}),Object.keys(this._computedWatchers).forEach(function(t){e._computedWatchers[t].teardown()}),this._data={},this._watchers=[],this._computedWatchers={}};return{observe:function(t){var e=t.onLoad,n=t.onUnload;return t.onLoad=function(){var t=this;this.model&&(this.model=this._vm=new X(this.model),new H(this._vm,function(){t.setData(t._vm.allData())},p,{},!0)),e&&e.apply(this,arguments)},t.onUnload=function(){this._vm&&this._vm.teardown(),n&&n.apply(this,arguments)},t},observable:function(t){return new X(t)},set:function(t,e,n){if(Array.isArray(t)&&s(e))return t.length=Math.max(t.length,e),t.splice(e,1,n),n;if(e in t&&!(e in Object.prototype))return t[e]=n;var r=t.__ob__;return t._isVue||r&&r.vmCount?n:r?(F(r.value,e,n),r.dep.notify(),n):t[e]=n},del:function(t,e){if(Array.isArray(t)&&s(e))t.splice(e,1);else{var n=t.__ob__;t._isVue||n&&n.vmCount||o(t,e)&&(delete t[e],n&&n.dep.notify())}}}});